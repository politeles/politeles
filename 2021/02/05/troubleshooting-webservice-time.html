<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Troubleshooting webservice time</h1><p class="page-description">A quick guide on how to troubleshoot webservice time</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-02-05T00:00:00-06:00" itemprop="datePublished">
        Feb 5, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#linux webservice">linux webservice</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#troubleshooting-webservice-at-os-level">Troubleshooting webservice at OS level</a></li>
</ul><h1 id="troubleshooting-webservice-at-os-level">
<a class="anchor" href="#troubleshooting-webservice-at-os-level" aria-hidden="true"><span class="octicon octicon-link"></span></a>Troubleshooting webservice at OS level</h1>
<p>We are trying to troubleshoot a webservice call that’s taking a lot of time. The initial idea it that the processing time in our platform is the issue. Let’s use <a href="https://jpons.es/2021/03/how-to-get-times-from-curl/">curl at OS level with the configuration as explained here</a> to troubleshoot.</p>

<p>This is the answer we get from the curl command:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
</span><span class="nl">"time_redirect"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.000</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_namelookup"</span><span class="p">:</span><span class="w"> </span><span class="mf">5.515</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_connect"</span><span class="p">:</span><span class="w"> </span><span class="mf">5.630</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_appconnect"</span><span class="p">:</span><span class="w"> </span><span class="mf">6.008</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_pretransfer"</span><span class="p">:</span><span class="w"> </span><span class="mf">6.008</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_starttransfer"</span><span class="p">:</span><span class="w"> </span><span class="mf">6.385</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">6.385</span><span class="p">,</span><span class="w">
</span><span class="nl">"size_request"</span><span class="p">:</span><span class="w"> </span><span class="mi">375</span><span class="p">,</span><span class="w">
</span><span class="nl">"size_upload"</span><span class="p">:</span><span class="w"> </span><span class="mi">103</span><span class="p">,</span><span class="w">
</span><span class="nl">"size_download"</span><span class="p">:</span><span class="w"> </span><span class="mi">375</span><span class="p">,</span><span class="w">
</span><span class="nl">"size_header"</span><span class="p">:</span><span class="w"> </span><span class="mi">343</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Here we see 5+ seconds in the name resolution. A first workaround is to get the IP address of the target and bypass the name server by using the hostname file:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nslookup webexapis.com
</code></pre></div></div>

<p>we will get several answers:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">Server:</span><span class="w">		</span><span class="mf">100.125</span><span class="err">.</span><span class="mf">4.25</span><span class="w">
</span><span class="err">Address:</span><span class="w">	</span><span class="mf">100.125</span><span class="err">.</span><span class="mf">4.25</span><span class="err">#</span><span class="mi">53</span><span class="w">

</span><span class="err">Non-authoritative</span><span class="w"> </span><span class="err">answer:</span><span class="w">
</span><span class="err">Name:</span><span class="w">	</span><span class="err">webexapis.com</span><span class="w">
</span><span class="err">Address:</span><span class="w"> </span><span class="mf">3.130</span><span class="err">.</span><span class="mf">32.130</span><span class="w">
</span><span class="err">Name:</span><span class="w">	</span><span class="err">webexapis.com</span><span class="w">
</span><span class="err">Address:</span><span class="w"> </span><span class="mf">3.139</span><span class="err">.</span><span class="mf">30.165</span><span class="w">
</span><span class="err">Name:</span><span class="w">	</span><span class="err">webexapis.com</span><span class="w">
</span><span class="err">Address:</span><span class="w"> </span><span class="mf">3.140</span><span class="err">.</span><span class="mf">133.193</span><span class="w">
</span></code></pre></div></div>

<p>we edit the /etc/hosts file and add that IP and host:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">3.140</span><span class="err">.</span><span class="mf">133.193</span><span class="w"> </span><span class="err">webexapis.com</span><span class="w">
</span></code></pre></div></div>

<p>if now we issue again the command, then let’s see if the issue is solved:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
</span><span class="nl">"time_redirect"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.000</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_namelookup"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.005</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_connect"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.118</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_appconnect"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.507</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_pretransfer"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.507</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_starttransfer"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.877</span><span class="p">,</span><span class="w">
</span><span class="nl">"time_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.877</span><span class="p">,</span><span class="w">
</span><span class="nl">"size_request"</span><span class="p">:</span><span class="w"> </span><span class="mi">375</span><span class="p">,</span><span class="w">
</span><span class="nl">"size_upload"</span><span class="p">:</span><span class="w"> </span><span class="mi">103</span><span class="p">,</span><span class="w">
</span><span class="nl">"size_download"</span><span class="p">:</span><span class="w"> </span><span class="mi">375</span><span class="p">,</span><span class="w">
</span><span class="nl">"size_header"</span><span class="p">:</span><span class="w"> </span><span class="mi">343</span><span class="w">
</span><span class="p">}</span><span class="w">


</span></code></pre></div></div>

<p>It seems the issue is related to the name server. Next step would be to troubleshoot the name server and see why it’s taking 5 seconds to resolve that url.</p>

  </div><a class="u-url" href="/2021/02/05/troubleshooting-webservice-time" hidden></a>
</article>
