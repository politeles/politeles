<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Indexing a website using javascript search engine | José Enrique Pons blog.</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Indexing a website using javascript search engine" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Post showing how to index a website using javascript tipuesearch." />
<meta property="og:description" content="Post showing how to index a website using javascript tipuesearch." />
<link rel="canonical" href="https://jpons.es/2015/06/15/indexing-a-website-using-javascript-search-engine" />
<meta property="og:url" content="https://jpons.es/2015/06/15/indexing-a-website-using-javascript-search-engine" />
<meta property="og:site_name" content="José Enrique Pons blog." />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-06-15T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Indexing a website using javascript search engine" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2015-06-15T00:00:00-05:00","datePublished":"2015-06-15T00:00:00-05:00","description":"Post showing how to index a website using javascript tipuesearch.","headline":"Indexing a website using javascript search engine","mainEntityOfPage":{"@type":"WebPage","@id":"https://jpons.es/2015/06/15/indexing-a-website-using-javascript-search-engine"},"url":"https://jpons.es/2015/06/15/indexing-a-website-using-javascript-search-engine"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://jpons.es/feed.xml" title="José Enrique Pons blog." /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RQNWGYTYCC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RQNWGYTYCC');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">José Enrique Pons blog.</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Indexing a website using javascript search engine</h1><p class="page-description">Post showing how to index a website using javascript tipuesearch.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2015-06-15T00:00:00-05:00" itemprop="datePublished">
        Jun 15, 2015
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#javascript python html">javascript python html</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
</ul><p>Hi, today I’m going to talk about an implementation on Javascript, called <a href="http://www.tipue.com/search/">tipue search</a>.
There are 2 possibilities, one is to perform the search online, that is, to lookup the files and do the search while querying. This is reported as not being as efficient as do an offline index.</p>

<p>So I build an index, based on json, using a python script.</p>

<p>Basically the json I wanted to create looks like this:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">var</span><span class="w"> </span><span class="err">tipuesearch</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="nl">"pages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
</span><span class="p">{</span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Welcome to JIVE - Guidelines | "</span><span class="p">,</span><span class="w"> </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Welcome to the  Jive Collaboration platform Please read this document, which contains"</span><span class="p">,</span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Welcome to JIVE - Guidelines | "</span><span class="p">,</span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.0.82.13/DOC-1001.html"</span><span class="p">},</span><span class="w">
</span><span class="p">{</span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Datacenter FAQ - NGA ISO Hosting | "</span><span class="p">,</span><span class="w"> </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Where are the datacenters located? Do you subcontract activities? We have several datacenters around"</span><span class="p">,</span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Datacenter FAQ - NGA ISO Hosting | "</span><span class="p">,</span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.0.82.13/DOC-1002.html"</span><span class="p">},</span><span class="w">
</span><span class="p">{</span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Customer Information template | "</span><span class="p">,</span><span class="w"> </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This document will need to become the template that is used to create the information of the custome"</span><span class="p">,</span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Customer Information template | "</span><span class="p">,</span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.0.82.13/DOC-1003.html"</span><span class="p">},</span><span class="w">
</span><span class="p">{</span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ISO Customer List | "</span><span class="p">,</span><span class="w"> </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Please add customers as content is created. Please ensure you add the name alphabetically. Insert fo"</span><span class="p">,</span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ISO Customer List | "</span><span class="p">,</span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.0.82.13/DOC-1004.html"</span><span class="p">},</span><span class="w">
</span><span class="p">{</span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Accenture Phillipines/Singapore - APH - Hosted | "</span><span class="p">,</span><span class="w"> </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CustomerAccenture Philippines/Singaporealso known asAPHISO Project CodeAPHContract Start date01 June"</span><span class="p">,</span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Accenture Phillipines/Singapore - APH - Hosted | "</span><span class="p">,</span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.0.82.13/DOC-1006.html"</span><span class="p">},</span><span class="w">
</span><span class="p">{</span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"KB: SAP logon screen hangs - Oracle | "</span><span class="p">,</span><span class="w"> </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"KeywordsORA 257 00257 ORA-00257 Archivelog system hangs logon login screenSymptomSAP logon screen ap"</span><span class="p">,</span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="s2">"KB: SAP logon screen hangs - Oracle | "</span><span class="p">,</span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://10.0.82.13/DOC-1007.html"</span><span class="p">},</span><span class="w">
</span><span class="p">]}</span><span class="err">;</span><span class="w">

</span></code></pre></div></div>

<p>The engine needs 3 attributes:</p>
<ul>
  <li>title: The title of the web site.</li>
  <li>text:Some of the content of the site.</li>
  <li>url: This is important, because on the search results, you will get a link with the url just to click on the results.</li>
</ul>

<p>I’m indexing some <a href="https://www.jivesoftware.com/">Jive documents</a>. So my script in python to generate the json looks like this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">urllib2.request</span>
<span class="kn">import</span> <span class="nn">glob</span><span class="p">,</span> <span class="n">os</span>
<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>


<span class="k">def</span> <span class="nf">paquillo</span><span class="p">():</span>


    <span class="n">max_lenth</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">tag_start</span> <span class="o">=</span> <span class="mi">11</span>

    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'D:\Documentos\index.json'</span><span class="p">,</span><span class="s">'w+'</span><span class="p">)</span>
    

    <span class="n">os</span><span class="p">.</span><span class="n">chdir</span><span class="p">(</span><span class="s">"D:\docs"</span><span class="p">)</span>
    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">glob</span><span class="p">.</span><span class="n">glob</span><span class="p">(</span><span class="s">"DOC-[0-9][0-9][0-9][0-9].html"</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Document: '</span><span class="o">+</span><span class="nb">file</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">codecs</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="s">'.jive-rendered-content'</span><span class="p">))</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="s">'.jive-rendered-content'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">text_lenth</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">.</span><span class="n">get_text</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">text_lenth</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">=</span><span class="n">max_lenth</span><span class="p">:</span>
                <span class="n">content_text</span> <span class="o">=</span>  <span class="n">text</span><span class="p">.</span><span class="n">get_text</span><span class="p">()[:</span><span class="n">max_lenth</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">text_lenth</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">content_text</span> <span class="o">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">title</span><span class="p">.</span><span class="n">string</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">content_text</span> <span class="o">=</span> <span class="n">text</span><span class="p">.</span><span class="n">get_text</span><span class="p">()</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">content_text</span> <span class="o">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">title</span><span class="p">.</span><span class="n">string</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="s">'.jive-icon-med .jive-icon-folder'</span><span class="p">))</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">tags</span> <span class="o">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="s">'.jive-icon-med .jive-icon-folder'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">tag_lenth</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tags</span><span class="p">.</span><span class="n">get_text</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">tag_lenth</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">tag_start</span><span class="p">:</span>
                <span class="n">tag_text</span> <span class="o">=</span> <span class="n">tags</span><span class="p">[:</span><span class="o">-</span><span class="n">tag_start</span><span class="p">]</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">tag_text</span> <span class="o">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">title</span><span class="p">.</span><span class="n">string</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">tag_text</span> <span class="o">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">title</span><span class="p">.</span><span class="n">string</span>

                    
                
        <span class="n">string_to_file</span> <span class="o">=</span>  <span class="p">(</span><span class="s">'{</span><span class="se">\"</span><span class="s">title</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">'</span><span class="o">+</span><span class="n">string</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="n">title</span><span class="p">.</span><span class="n">string</span><span class="p">,</span><span class="s">'</span><span class="se">\"</span><span class="s">'</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span><span class="o">+</span><span class="s">'</span><span class="se">\"</span><span class="s">, </span><span class="se">\"</span><span class="s">text</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">'</span><span class="o">+</span>
              <span class="n">string</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="n">content_text</span><span class="p">,</span><span class="s">'</span><span class="se">\"</span><span class="s">'</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span><span class="o">+</span><span class="s">'</span><span class="se">\"</span><span class="s">,'</span><span class="o">+</span>
              <span class="s">'</span><span class="se">\"</span><span class="s">tags</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">'</span><span class="o">+</span><span class="n">string</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tag_text</span><span class="p">,</span><span class="s">'</span><span class="se">\"</span><span class="s">'</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span><span class="o">+</span><span class="s">'</span><span class="se">\"</span><span class="s">,'</span><span class="o">+</span>
              <span class="s">'</span><span class="se">\"</span><span class="s">url</span><span class="se">\"</span><span class="s">: </span><span class="se">\"</span><span class="s">'</span> <span class="o">+</span>  <span class="s">'http://10.0.82.13/'</span> <span class="o">+</span> <span class="nb">file</span> <span class="o">+</span><span class="s">'</span><span class="se">\"</span><span class="s">},'</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span>           
        <span class="n">output_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">string_to_file</span><span class="p">)</span>

    <span class="n">output_file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   <span class="c1"># sys.setdefaultencoding('utf-8')
</span>    <span class="c1">#reload(sys)
</span>    <span class="n">paquillo</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

</code></pre></div></div>


  </div><a class="u-url" href="/2015/06/15/indexing-a-website-using-javascript-search-engine" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>My tech blog on AI/ML and IT stuff in general.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/politeles" target="_blank" title="politeles"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/jose_e_pons" target="_blank" title="jose_e_pons"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
