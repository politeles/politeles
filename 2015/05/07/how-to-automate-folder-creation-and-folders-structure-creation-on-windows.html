<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How to automate folder creation in windows</h1><p class="page-description">Practical example using the script to automate folder creation</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2015-05-07T00:00:00-05:00" itemprop="datePublished">
        May 7, 2015
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#windows cli folder">windows cli folder</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
</ul><p>In this post I’m going to show some script files using the old batch scripting style that works perfectly on windows 7 an on. You will find very good books and reviews on the internet like <a href="http://en.wikibooks.org/wiki/Windows_Batch_Scripting">Windows_Batch_Scripting</a>.</p>

<p>In my case we need to automate the creation of the following folder structure:</p>
<ul>
  <li>Main Folder</li>
  <li>Sub Folder</li>
  <li>Sub Sub Folder
    - Folder 1
    - Folder 2
    - Folder 3
    - Folder n</li>
</ul>

<p>So I developed the following a small batch script to create interfaces. First I check the arguments and set some initial variables, like the starting folder and so.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@ECHO OFF
REM Create folders <span class="k">for </span>a new interface
REM Parameters: Folder SubFolder SubSubfolder

<span class="nb">set </span><span class="nv">basefolder</span><span class="o">=</span>c:<span class="se">\</span>
<span class="nb">set </span><span class="nv">folders</span><span class="o">=(</span>folder1 folder2 folder3 foldern<span class="o">)</span>

<span class="nb">set </span><span class="nv">argC</span><span class="o">=</span>0
<span class="k">for</span> %%x <span class="k">in</span> <span class="o">(</span>%<span class="k">*</span><span class="o">)</span> <span class="k">do </span>Set /A argC+<span class="o">=</span>1

:parametercheck
<span class="k">if</span> -%argC%- lss 3 <span class="o">(</span>
goto :wrongcall
<span class="o">)</span>
</code></pre></div></div>

<p>The script loops on the folders variable and create the structure:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo </span>Creating folder interfaces:

:folderloop
<span class="k">for</span> %%i <span class="k">in</span> %folders% <span class="k">do</span> <span class="o">(</span>
<span class="nb">echo  mkdir</span> %basefolder%<span class="se">\%</span>1<span class="se">\%</span>2<span class="se">\%</span>3<span class="se">\%</span>%i
<span class="nb">mkdir</span> %basefolder%<span class="se">\%</span>1<span class="se">\%</span>2<span class="se">\%</span>3<span class="se">\%</span>%i
<span class="o">)</span>
goto :end
</code></pre></div></div>

<p>Finally I handle wrong calls with the following code:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:wrongcall

<span class="nb">echo </span>Wrong call.
<span class="nb">echo</span> %0 Folder SubFolder SubSubFolder
<span class="nb">echo </span>Where
<span class="nb">echo </span>Folder : Is the main folder
<span class="nb">echo </span>SubFolder : Is the secondary folder
<span class="nb">echo </span>SubSubFolder Is the SubSubFolder
<span class="nb">echo </span>sample usage:
<span class="nb">echo</span> %0 folder1 sfmt int12
</code></pre></div></div>

<p>I automated the creation of folders with a call from an external batch file, so I can create multiple folders:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@ECHO OFF
REM Create folders sets

<span class="nb">set </span><span class="nv">argC</span><span class="o">=</span>0
<span class="k">for</span> %%x <span class="k">in</span> <span class="o">(</span>%<span class="k">*</span><span class="o">)</span> <span class="k">do </span>Set /A argC+<span class="o">=</span>1
:parametercheck
<span class="k">if</span> -%argC%- lss 1 <span class="o">(</span>
goto :wrongcall
<span class="o">)</span>

<span class="k">for</span> /F <span class="s2">"tokens=*"</span> %%A <span class="k">in</span> <span class="o">(</span>%1<span class="o">)</span> <span class="k">do </span>CALL new_itf.bat %%A

goto :end

:wrongcall

<span class="nb">echo </span>Wrong call.
<span class="nb">echo</span> %0 config_file
<span class="nb">echo </span>Where
<span class="nb">echo </span>config_file: configuration file
<span class="nb">echo </span>sample usage:
<span class="nb">echo</span> %0 folders.txt
:end
</code></pre></div></div>

<p>Where <em>new_itf.bat</em> is the name I gave to the other batch file. 
The aspect of the configuration file is quite simple:</p>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">Folder</span> <span class="err">SubFolder</span> <span class="err">SubSubFolder1</span>
<span class="err">Folder</span> <span class="err">SubFolder</span> <span class="err">SubSubFolder2</span>
<span class="err">Folder</span> <span class="err">SubFolder</span> <span class="err">SubSubFolder3</span>
<span class="err">Folder</span> <span class="err">SubFolder</span> <span class="err">SubSubFolder4</span>
</code></pre></div></div>

  </div><a class="u-url" href="/2015/05/07/how-to-automate-folder-creation-and-folders-structure-creation-on-windows" hidden></a>
</article>
