<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Problems when using webservice from Javascript CORS</h1><p class="page-description">Some ideas on how to solve problems with CORS.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2015-08-26T00:00:00-05:00" itemprop="datePublished">
        Aug 26, 2015
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#webservices nodejs javascript CORS">webservices nodejs javascript CORS</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
</ul><p>Hi, I’ve been fighting the whole day for the security constraint that makes your browser blocks your JS code when trying to reach an external server.
Thas was solved on the  standard Cross Origin Resource Sharing. (CORS for short).
In my node JS server code I had to adapt the following:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//enable Cross Origin Resource Sharing</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="dl">"</span><span class="s2">Access-Control-Allow-Origin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">*</span><span class="dl">"</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="dl">'</span><span class="s1">Access-Control-Allow-Methods</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">GET,PUT,POST,DELETE,OPTIONS</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="dl">"</span><span class="s2">Access-Control-Allow-Headers</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Origin, X-Requested-With, Content-Type, Accept</span><span class="dl">"</span><span class="p">);</span>
  <span class="nx">next</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>

<p>and on my Jquery I did:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//This is how your data looks like:</span>
<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span><span class="dl">"</span><span class="s2">answers</span><span class="dl">"</span><span class="p">:</span> 
	<span class="p">[</span>
	<span class="p">{</span><span class="dl">"</span><span class="s2">testNo</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">1</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">answerNo</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">2</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">answerValue</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">answer1</span><span class="dl">"</span><span class="p">},</span>
	<span class="p">{</span><span class="dl">"</span><span class="s2">testNo</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">1</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">answerNo</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">2</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">answerValue</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">answer1</span><span class="dl">"</span><span class="p">}</span>
	<span class="p">],</span>
	<span class="dl">"</span><span class="s2">userId</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">idUser</span><span class="dl">"</span><span class="p">};</span>


<span class="c1">// This is the object for the configuration:</span>
<span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{};</span>
	  <span class="nx">config</span><span class="p">.</span><span class="nx">method</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">PUT</span><span class="dl">"</span><span class="p">;</span>
	  <span class="nx">config</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">http://localhost:8080/api/users</span><span class="dl">"</span><span class="p">;</span>
	  <span class="nx">config</span><span class="p">.</span><span class="nx">contentType</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">;</span>
	  <span class="nx">config</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
	  <span class="nx">config</span><span class="p">.</span><span class="nx">datatype</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">;</span>

	  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span>
			<span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">){</span>
					<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">,</span><span class="dl">"</span><span class="s2">Function called: </span><span class="dl">"</span><span class="o">+</span><span class="nx">msg</span><span class="p">);</span>
	  <span class="p">});</span>
</code></pre></div></div>

<p>The full code of this is <a href="https://github.com/politeles/nodejs_mongo_server">available at my github account</a></p>

  </div><a class="u-url" href="/2015/08/26/problems-when-using-webservice-from-javascript-cors" hidden></a>
</article>
